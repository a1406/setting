# others
next key locking 避免幻读

插入缓冲 insert buffer

二次写  double write

自适应哈希索引  adaptive hash index

预读  read ahead

show engine innodb status 可以看大量innodb的状态

# 2.3  innodb体系架构
## 线程
master thread 缓冲刷新：
脏页刷新  合并插入缓冲  undo页回收

io thread：
处理AIO的回调，一般是4个  read，write，insert buffer，log 

purge thread：
回收事务提交之后的undo log

page clean thread：
后来加入的，把原master thread的脏页刷新移到这里来

## 内存
缓存大小配置：
show variables like  'innodb_buffer_size';

缓存类型：
- 索引页
- 数据页
- undo页
- 插入缓冲 insert buffer
- 自适应哈希索引  adaptive hash index
- 锁信息  lock info
- 数据字典信息  data dict

此外还有重做日志缓冲
redo log_buffer

### 内存的lru算法
在lru的基础上，添加了midpoint位置（innodb_old_blocks_pct），只有在midpoint之下， 也就是old区域超过一定时间（innodb_old_blocks_time），才会加入lru的头部，这样可以避免大量的lru头部因为某个一次性的扫描被换出

### flush列表
LRU中的页被修改后，被称为脏页（dirty page），脏页同时也存在与flush列表。

### 重做日志缓冲（redo log buffer）
默认8M， 每秒master线程会刷新重做日志缓冲到磁盘，事务提交时也会刷新到磁盘，或者buffer小于一半时，也会刷新到磁盘

# 2.4 checkpoint技术
数据库宕机时，只需要重做日志恢复checkpoint之后的部分
如果LRP要移除脏页，那么需要强制checkpoint

## LSN（log seq number）
LSN是8字节数字，单位是字节，每个页有LSN，重做日志也有LSN，checkpoint也有LSN
